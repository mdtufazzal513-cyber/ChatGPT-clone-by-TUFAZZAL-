<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatGPT Clone</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
  :root {
    --bg-color: #000000; /* Pure black background */
    --chat-bg: #000000; /* Chat area background */
    --input-bg: #212121; /* Dark grey for input */
    --text-color: #ffffff; /* White text */
    --send-btn-bg: #ffffff; /* White send button */
    --send-btn-icon: #000000; /* Black icon for send button */
    --user-bubble-bg: #414141; /* Slightly lighter grey for user bubbles */
    --bot-bubble-bg: #303030; /* Darker grey for bot bubbles */
    --header-color: #ffffff; /* White header text */
    --icon-color: #b0b0b0; /* Light grey for header icons */
    --menu-icon: #ffffff; /* White for menu icon */
  }

  body {
    font-family: 'Noto Sans Bengali', sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: flex-end; /* Align to bottom for chat input */
    min-height: 100vh;
  }

  .chat-container {
    background-color: var(--chat-bg);
    width: 100%;
    max-width: 600px;
    height: 100vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.05);
    overflow: hidden;
  }

  .chat-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background-color: var(--chat-bg); /* Match chat background */
    border-bottom: 1px solid #1a1a1a; /* Subtle separator */
    color: var(--header-color);
    font-size: 1.2em;
    font-weight: 500;
  }

  .chat-header .title {
    flex-grow: 1;
    text-align: center;
  }

  .chat-header .icon {
    font-size: 1.1em;
    cursor: pointer;
    padding: 5px;
  }

  .chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 15px 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .message-wrapper {
    display: flex;
    justify-content: flex-start; /* Default for bot, adjusted for user */
    width: 100%;
  }

  .message {
    max-width: 80%;
    padding: 12px 16px;
    border-radius: 18px;
    word-wrap: break-word;
    color: var(--text-color);
    line-height: 1.5;
    animation: fadeInMessage 0.3s ease-out;
  }

  .user-msg .message {
    background-color: var(--user-bubble-bg);
    align-self: flex-end;
    margin-left: auto; /* Push user message to the right */
    border-bottom-right-radius: 6px; /* Similar to screenshot */
  }

  .bot-msg .message {
    background-color: var(--bot-bubble-bg);
    align-self: flex-start;
    border-bottom-left-radius: 6px; /* Similar to screenshot */
  }

  .message-actions {
    display: flex;
    gap: 15px;
    margin-top: 8px;
    font-size: 0.9em;
    color: var(--icon-color);
  }

  .message-actions .action-icon {
    cursor: pointer;
    transition: color 0.2s ease;
  }

  .message-actions .action-icon:hover {
    color: var(--primary-color);
  }

  .chat-input-area {
    padding: 10px 15px;
    background-color: var(--chat-bg);
    border-top: 1px solid #1a1a1a;
  }

  .chat-input {
    display: flex;
    align-items: center;
    background-color: var(--input-bg);
    border-radius: 25px; /* Rounded input field */
    padding: 8px 15px;
  }

  .chat-input input {
    flex: 1;
    border: none;
    background: transparent;
    color: var(--text-color);
    font-size: 1em;
    padding: 5px 10px;
    outline: none;
  }

  .chat-input .send-button {
    background-color: var(--send-btn-bg);
    border: none;
    border-radius: 50%;
    width: 38px;
    height: 38px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    margin-left: 10px;
    transition: background-color 0.2s ease, transform 0.2s ease;
  }

  .chat-input .send-button:hover {
    background-color: #cccccc;
  }
  .chat-input .send-button:active {
    transform: scale(0.95);
  }

  .chat-input .send-button i {
    color: var(--send-btn-icon);
    font-size: 1.1em;
  }

  @keyframes fadeInMessage {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Typing Indicator */
  .typing-indicator-wrapper {
    display: flex;
    justify-content: flex-start;
    width: 100%;
  }
  .typing-indicator {
    display: inline-flex;
    align-items: center;
    background-color: var(--bot-bubble-bg);
    padding: 12px 16px;
    border-radius: 18px;
    border-bottom-left-radius: 6px;
    max-width: 80%;
  }

  .typing-indicator span {
    width: 6px;
    height: 6px;
    background-color: var(--text-color);
    border-radius: 50%;
    margin: 0 2px;
    animation: bounce 1.4s infinite ease-in-out;
    opacity: 0.7;
  }

  .typing-indicator span:nth-child(2) {
    animation-delay: 0.2s;
  }

  .typing-indicator span:nth-child(3) {
    animation-delay: 0.4s;
  }

  @keyframes bounce {
    0%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-6px); }
  }
</style>
</head>
<body>

<div class="chat-container">
  <div class="chat-header">
    <i class="fas fa-bars icon" style="color: var(--menu-icon);"></i>
    <div class="title">ChatGPT</div>
    <i class="fas fa-edit icon" style="color: var(--icon-color);"></i>
    <i class="fas fa-ellipsis-v icon" style="color: var(--icon-color); margin-left: 15px;"></i>
  </div>

  <div class="chat-messages" id="chatMessages">
    <!-- Initial bot message -->
    <div class="message-wrapper bot-msg">
      <div class="message">
        ‡¶π‡¶æ‡ßü! ‡¶ï‡ßá‡¶Æ‡¶® ‡¶Ü‡¶õ‡ßã? <span style="font-size:1.2em;">üòä</span>
        <div class="message-actions">
          <i class="far fa-thumbs-up action-icon"></i>
          <i class="far fa-thumbs-down action-icon"></i>
          <i class="fas fa-volume-up action-icon"></i>
          <i class="fas fa-redo-alt action-icon"></i>
          <i class="fas fa-share-alt action-icon"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="chat-input-area">
    <div class="chat-input">
      <i class="far fa-image" style="color: var(--icon-color); font-size: 1.2em; margin-right: 10px; cursor: pointer;"></i>
      <input type="text" id="userInput" placeholder="Message" aria-label="Message">
      <button class="send-button" id="sendBtn">
        <i class="fas fa-arrow-up"></i>
      </button>
    </div>
  </div>
</div>

<script>
  const chatMessages = document.getElementById('chatMessages');
  const userInput = document.getElementById('userInput');
  const sendBtn = document.getElementById('sendBtn');

  const OPENROUTER_API_KEY = "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";
  const OPENROUTER_ENDPOINT = "https://openrouter.ai/api/v1/chat/completions";
  const OPENROUTER_MODEL = "qwen/qwen3-30b-a3b:free"; // Or a more conversational model if available/preferred

  // Updated system prompt for a general chatbot
  const systemPrompt = `You are a helpful and friendly AI assistant, like ChatGPT. You can answer a wide range of questions, provide information, generate creative content, and assist with various tasks. You are multilingual and will respond in the language the user uses.
Your responses should be natural, engaging, and informative.`;

  async function sendMessage() {
    const userText = userInput.value.trim();
    if (!userText) return;

    appendMessage(userText, "user-msg");
    userInput.value = ""; // Clear input immediately

    // Display typing indicator
    const typingIndicatorWrapper = document.createElement('div');
    typingIndicatorWrapper.className = 'typing-indicator-wrapper';
    const typingIndicator = document.createElement('div');
    typingIndicator.className = 'typing-indicator';
    typingIndicator.innerHTML = '<span></span><span></span><span></span>';
    typingIndicatorWrapper.appendChild(typingIndicator);
    chatMessages.appendChild(typingIndicatorWrapper);
    chatMessages.scrollTop = chatMessages.scrollHeight;

    try {
      const response = await fetch(OPENROUTER_ENDPOINT, {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${OPENROUTER_API_KEY}`,
          "Content-Type": "application/json",
          "HTTP-Referer": window.location.href,
          "X-Title": "ChatGPT Clone",
        },
        body: JSON.stringify({
          model: OPENROUTER_MODEL,
          messages: [
            { role: "system", content: systemPrompt },
            { role: "user", content: userText }
          ],
        })
      });

      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(`API Error: ${response.status} - ${errorData.message || 'Unknown error'}`);
      }

      const data = await response.json();
      const botResponse = data.choices[0].message.content;

      // Remove typing indicator before appending bot message
      if (typingIndicatorWrapper.parentNode) {
        typingIndicatorWrapper.parentNode.removeChild(typingIndicatorWrapper);
      }
      appendMessage(botResponse, "bot-msg");

    } catch (error) {
      console.error("Error fetching AI response:", error);
      // Remove typing indicator even on error
      if (typingIndicatorWrapper.parentNode) {
        typingIndicatorWrapper.parentNode.removeChild(typingIndicatorWrapper);
      }
      appendMessage("‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§", "bot-msg");
    }
  }

  function appendMessage(text, className) {
    const messageWrapper = document.createElement('div');
    messageWrapper.className = `message-wrapper ${className}`;
    
    const msgDiv = document.createElement('div');
    msgDiv.className = `message`;
    msgDiv.textContent = text; // Use textContent for plain text
    
    messageWrapper.appendChild(msgDiv);

    // Add action icons only for the first bot message and new bot messages
    if (className === "bot-msg") {
      const actionsDiv = document.createElement('div');
      actionsDiv.className = 'message-actions';
      actionsDiv.innerHTML = `
        <i class="far fa-thumbs-up action-icon"></i>
        <i class="far fa-thumbs-down action-icon"></i>
        <i class="fas fa-volume-up action-icon"></i>
        <i class="fas fa-redo-alt action-icon"></i>
        <i class="fas fa-share-alt action-icon"></i>
      `;
      msgDiv.appendChild(actionsDiv);
    }

    chatMessages.appendChild(messageWrapper);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  // Event Listeners
  sendBtn.addEventListener('click', sendMessage);
  userInput.addEventListener('keydown', (event) => {
    if (event.key === 'Enter') {
      sendMessage();
    }
  });

</script>

</body>
</html>